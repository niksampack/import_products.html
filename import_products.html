<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>๐ Excel Inspector (Debug Mode)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-800 text-white p-10 font-mono">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-4 text-yellow-400">๐ ุงุจุฒุงุฑ ุนุจโุงุจ ูุงู ุงฺฉุณู</h1>
        <p class="mb-4">ูุง ูโุฎูุงูู ุจุจูู ฺฉุงููพูุชุฑ ฺู ุณุชููโูุง ุฑุง ูโุจูุฏ.</p>

        <input type="file" id="fileInput" class="block w-full mb-4 p-4 bg-gray-700 rounded" onchange="inspectFile()">
        
        <div class="mt-4">
            <h3 class="text-xl font-bold text-blue-400">ูุชุงุฌ ุขูุงูุฒ:</h3>
            <pre id="output" class="bg-black p-4 rounded border border-gray-600 overflow-auto h-96 text-xs text-green-400"></pre>
        </div>
    </div>

    <script>
        function log(msg) {
            document.getElementById('output').innerHTML += msg + "\n";
        }

        function inspectFile() {
            const fileInput = document.getElementById('fileInput');
            const output = document.getElementById('output');
            output.innerHTML = "โณ ุฏุฑ ุญุงู ุฎูุงูุฏู ูุงู...\n";

            if (!fileInput.files.length) return;

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    log("โ ูุงู ุฎูุงูุฏู ุดุฏ.");
                    log(`๐ ูุงู ุดุชโูุง: ${workbook.SheetNames.join(", ")}`);

                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                    // ุชุจุฏู ุดุช ุจู JSON
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 }); // ุญุงูุช ุขุฑุงูโุง (ุฎุงู)

                    if (jsonData.length === 0) {
                        log("โ ูุงู ุฎุงู ุงุณุช!");
                        return;
                    }

                    log("--------------------------------------------------");
                    log(`๐ ุฑุฏู ุงูู (ุงุญุชูุงูุงู ุชุชุฑูุง):`);
                    log(JSON.stringify(jsonData[0], null, 2)); // ููุงุด ุฑุฏู ุงูู
                    
                    log("--------------------------------------------------");
                    log(`๐ฆ ุฑุฏู ุฏูู (ุงููู ูุญุตูู):`);
                    if (jsonData.length > 1) {
                        log(JSON.stringify(jsonData[1], null, 2));
                    } else {
                        log("โ ุฑุฏู ุฏูู ูุฌูุฏ ูุฏุงุฑุฏ.");
                    }

                    log("--------------------------------------------------");
                    log("๐ก ุชุญูู:");
                    const headers = jsonData[0];
                    const likelyCodeIndex = headers.findIndex(h => h && String(h).toLowerCase().includes("code") || String(h).toLowerCase().includes("nr"));
                    
                    if (likelyCodeIndex > -1) {
                        log(`โ ุณุชูู ฺฉุฏ ูพุฏุง ุดุฏ ุฏุฑ ุงูุฏฺฉุณ: ${likelyCodeIndex} (ูุงู: ${headers[likelyCodeIndex]})`);
                    } else {
                        log("โ ูฺ ุณุชูู ุดุจู ุจู 'Code' ุง 'Nr' ุฏุฑ ุฑุฏู ุงูู ูพุฏุง ูุดุฏ.");
                        log("โ๏ธ ุดุงุฏ ุชุชุฑูุง ุฏุฑ ุฑุฏู ฑ ูุณุชูุฏุ");
                    }

                } catch (err) {
                    log("โ ุฎุทุง: " + err.message);
                }
            };

            reader.readAsArrayBuffer(file);
        }
    </script>
</body>
</html>
